จากในห้องที่เรียนเรื่อง fetch API และมาต่อยอดในเรื่องของ Method เลยไปหาโจทย์จาก ChatGPT มานั่งลองฝึกดูครับ

ขั้นตอนและสิ่งที่ได้ฝึก

const postList = document.getElementById("postList"); --> เข้าถึง element ด้วย id = postList
const loadMoreBtn = document.getElementById("loadMoreBtn"); --> เข้าถึง element ด้วย id = loadMoreBtn
const doneMsg = document.getElementById("doneMsg"); --> เข้าถึง element ด้วย id = doneMsg

let currentPage = 1; --> กำหนดให้ currentPage = 1
const limit = 2; --> กำหนดให้ limit = 2 แสดงทีละ 2 บรรทัด
const maxPosts = 10; --> กำหนดให้ maxPosts = 10 หมายถึงจำนวนที่เต็มคือ 10 

async function loadPosts() {
  try {
    const response = await fetch(
      `https://jsonplaceholder.typicode.com/posts?_page=${currentPage}&_limit=${limit}`
    );
    const data = await response.json(); --> รอจากการ fetch ให้ได้่ json มา

    data.forEach((post) => {
      const div = document.createElement("div"); --> สร้าง element div
      div.className = "post"; --> กำหนด classname = post
      div.textContent = `${post.id}: ${post.title}`; --> จัด format และ add เข้าไปใน div
      postList.appendChild(div); --> append div -> postList
    }); 

    currentPage++; --> เมื่อสร้างบรรทัดแล้วเป็น div ก็จะบวกทีละ 2 เพระเรากำหนดไว้

    if ((currentPage - 1) * limit >= maxPosts) { --> เช็คว่าเรา append ไปครบตามที่กำหนดหรือยัง
      loadMoreBtn.style.display = "none"; --> ทำให้ปุ่ม loadMoreBtn display:none
      doneMsg.textContent = "load finish"; --> เพิ่ม text เข้าไปใน doneMsg
    }

    if (data.length < limit) { --> เช็คว่าสามารถ load ได้เพิ่มไหม
      loadMoreBtn.style.display = "none";
      doneMsg.textContent = "Not more load";
    }
  } catch (error) {
    doneMsg.textContent = "Error kubbb";
    console.error(error);
  }
}

loadPosts(); --> เรียกใช้ funtion loadPosts 

loadMoreBtn.addEventListener("click", loadPosts); --> addEventListener ให้กับปุ่มเพื่อกดแล้วให้เรียกใช้ function loadPosts
